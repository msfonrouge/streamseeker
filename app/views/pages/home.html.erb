<div id="bg-image">
  <div class="container full-height">
    <div class="text-center">
      <%= image_tag "logo.png" %>
    </div>
    <div data-controller="search">
      <div class="row d-flex justify-content-center my-3">
        <%= simple_form_for :search, url: root_path, method: :get, html: {class: "mb-4", data: {search_target: "form"}} do |f| %>
          <div class="search-form-control form-group" >
            <%= f.input :query, input_html: { class: 'form-control string required my-3', id: 'search_query', data: { search_target: "input", action: "keyup->search#submit" } }, label: false %>
            <%= button_tag :submit, class: 'btn btn-primary rounded-right top-0 bottom-0 end-0', value: 'Search' do %>
              <i class="fas fa-search"></i> Search
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
    <div class="">
      <ul class=" d-flex  flex-wrap justify-content-center gap-3">
        <% @genres.each do |genre| %>
          <%= link_to movies_path, class: 'text-white' do %>
            <%= button_tag genre, class: 'btn bg-dark text-white' %>
          <% end %>
        <% end %>
      </ul>
    </div>
  </div>
</div>
<div class="container d-flex justify-content-center flex-wrap mt-5">
  <% @movies.each do |movie| %>
    <div class="card-trip m-3">
      <% if movie.photo.attached? %> <%= cl_image_tag movie.photo.key, height:
    300, width: 200, crop: :scale, class:"card-img-top"%> <% end %>
      <div class="card-trip-infos col">
        <div>
          <h2><%= movie.title %></h2>
          <p><%= movie.year %></p>
        </div>
      </div>
    </div>
  <% end %>
</div>
<% results = PgSearch.multisearch(params[:search][:query]) if params[:search] && params[:search][:query].present? %>
<% if results %>
  <% results.each do |result| %>
    <% movie = result.searchable %>
    <p><%= movie.title %></p>
    <% if movie.photo.present? %>
      <%= cl_image_tag movie.photo.key, height: 300, width: 200, crop: :scale %>
    <% else %>
      <p>No hay imagen</p>
    <% end %>
  <% end %>
<% end %>
